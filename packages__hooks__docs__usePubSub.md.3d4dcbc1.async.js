(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[67,63],{"0Owb":function(e,n,t){"use strict";function a(){return a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},a.apply(this,arguments)}t.d(n,"a",(function(){return a}))},FBPY:function(e,n,t){"use strict";t.r(n);var a=t("PArb"),r=t("BMrR"),s=t("2/Rp"),u=t("kPKH"),i=t("5rEg"),o=t("KrTs"),c=t("tJVT"),l=t("q1tI"),b=t.n(l),d=t("GvIC"),m={sendMessage:"sendMessage"};function p(){var e=Object(l["useState"])(""),n=Object(c["a"])(e,2),t=n[0],a=n[1];return Object(d["c"])(m.sendMessage,((e,n)=>{a(n)})),b.a.createElement(b.a.Fragment,null,b.a.createElement(o["a"],{dot:!0},"\u6d88\u606f"),b.a.createElement(i["a"].TextArea,{value:t}))}function f(){var e=Object(l["useState"])(""),n=Object(c["a"])(e,2),t=n[0],a=n[1],o=e=>{e.preventDefault(),d["a"].publish(m.sendMessage,"".concat(t,"-").concat((new Date).getTime())),a("")};return b.a.createElement(i["a"].Group,null,b.a.createElement(r["a"],null,b.a.createElement(u["a"],{span:22},b.a.createElement(i["a"],{value:t,onChange:e=>{a(e.target.value)},defaultValue:"receive"})),b.a.createElement(u["a"],{span:2},b.a.createElement(s["a"],{onClick:o,type:"primary"},"\u53d1\u9001"))))}n["default"]=()=>b.a.createElement(b.a.Fragment,null,b.a.createElement(p,null),b.a.createElement(a["a"],null),b.a.createElement(f,null))},GvIC:function(e,n,t){"use strict";t.d(n,"b",(function(){return b})),t.d(n,"c",(function(){return p})),t.d(n,"a",(function(){return m.a}));var a,r=t("tJVT"),s=t("rAM+"),u=t("q1tI"),i=new Set,o={xs:{min:-1/0,max:576},sm:{min:576,max:768},md:{min:768,max:992},lg:{min:992,max:1200},xl:{min:1200,max:1600},xxl:{min:1600,max:1/0}};function c(){a||(a={size:{height:0,width:0},screen:"xs"},l(),window.addEventListener("resize",(()=>{var e=a;if(l(),e!==a){var n,t=Object(s["a"])(i);try{for(t.s();!(n=t.n()).done;){var r=n.value;r()}}catch(u){t.e(u)}finally{t.f()}}})))}function l(){for(var e,n=window.innerWidth,t=window.innerHeight,r={size:{width:n,height:t}},s=!1,u=0,i=Object.keys(o);u<i.length;u++){var c=i[u];if(e=o[c],n>=e.min&&n<e.max){r.screen=c,s=!0;break}}(s||r.size.width!==a.size.width||r.size.height!==a.size.height)&&(a=r)}function b(){c();var e=Object(u["useState"])(a),n=Object(r["a"])(e,2),t=n[0],s=n[1];return Object(u["useEffect"])((()=>{var e=()=>{s(a)};return i.add(e),()=>{i.delete(e)}}),[]),t}var d=t("kRpH"),m=t.n(d);function p(e,n){Object(u["useEffect"])((()=>{var t=m.a.subscribe(e,n);return()=>{m.a.unsubscribe(t)}}),[])}},"K+nK":function(e,n){function t(e){return e&&e.__esModule?e:{default:e}}e.exports=t},f6G0:function(e,n,t){"use strict";t.r(n);var a=t("0Owb"),r=t("q1tI"),s=t.n(r),u=(t("B2uJ"),t("+su7"),t("qOys")),i=t.n(u),o=t("5Yjd"),c=t.n(o),l=s.a.memo((function(){var e=t("K+nK"),n=e(t("q1tI")),a=e(t("FBPY")),r=function(){return n.default.createElement(a.default,null)};return n["default"].createElement(r)}));n["default"]=function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"markdown"},s.a.createElement("h1",{id:"usepubsub-publish-and-subscribe"},s.a.createElement("a",{"aria-hidden":"true",href:"#usepubsub-publish-and-subscribe"},s.a.createElement("span",{className:"icon icon-link"})),"usePubSub-Publish and Subscribe"),s.a.createElement("p",null,"Event notification between multiple components can sometimes be a headache. With PubSub, this process can be made easier."),s.a.createElement("p",null,"Call ",s.a.createElement("code",null,"useSubscribe")," in the component to subscribe to an event (the component will automatically unsubscribe when it is consumed)"),s.a.createElement("p",null,"An event can be published through ",s.a.createElement("code",null,"PubSub.publish")),s.a.createElement("p",null,"If necessary, you can use ",s.a.createElement("code",null,"PubSub.publish")," and ",s.a.createElement("code",null,"PubSub.subscribe")," to subscribe and publish in non-components (Note: If you own PubSub.subscribe, please pay attention to call ",s.a.createElement("code",null,"PubSub.unsubscribe")," to cancel subscription)"),s.a.createElement(i.a,{code:"useSubscribe(event:string,(event:string,data:any)=>void);\n",lang:"js"}),s.a.createElement("blockquote",null,s.a.createElement("p",null,"When the component is rendered multiple times, the return value obtained by calling ",s.a.createElement("code",null,"useSubscribe")," for each rendering will remain unchanged and will not be subscribed repeatedly.")),s.a.createElement(i.a,{code:"PubSub.publish((event: string), (data: any));\n",lang:"js"}),s.a.createElement("p",null,"For the case of ",s.a.createElement("strong",null,"child component")," notifying ",s.a.createElement("strong",null,"parent component"),", we still recommend using ",s.a.createElement("code",null,"props")," to pass an ",s.a.createElement("code",null,"event")," function directly. ",s.a.createElement("code",null,"useSubscribe")," is suitable for event notifications between components that are ",s.a.createElement("strong",null,"far away"),", or to share event notifications between ",s.a.createElement("strong",null,"multiple")," components."),s.a.createElement("h2",{id:"code-demo"},s.a.createElement("a",{"aria-hidden":"true",href:"#code-demo"},s.a.createElement("span",{className:"icon icon-link"})),"Code Demo"),s.a.createElement("h3",{id:"child-component-publish-parent-component-subscribe"},s.a.createElement("a",{"aria-hidden":"true",href:"#child-component-publish-parent-component-subscribe"},s.a.createElement("span",{className:"icon icon-link"})),"Child component publish parent component subscribe")),s.a.createElement(c.a,Object(a["a"])({source:{tsx:"import React, { useState } from 'react';\nimport { Button, Input, Badge, Divider, Row, Col } from 'antd';\nimport { PubSub, useSubscribe } from '@wetrial/hooks';\n\nconst eventType = {\n  sendMessage: 'sendMessage',\n};\n\nfunction MessageList() {\n  const [messages, setMessages] = useState('');\n\n  useSubscribe(eventType.sendMessage, (_, data) => {\n    setMessages(data);\n  });\n\n  return (\n    <>\n      <Badge dot>\u6d88\u606f</Badge>\n      <Input.TextArea value={messages} />\n    </>\n  );\n}\n\nfunction Chat() {\n  const [message, setMessage] = useState('');\n\n  const sendMessage = (e) => {\n    e.preventDefault();\n    PubSub.publish(eventType.sendMessage, `${message}-${new Date().getTime()}`);\n    setMessage('');\n  };\n\n  return (\n    <Input.Group>\n      <Row>\n        <Col span={22}>\n          <Input\n            value={message}\n            onChange={(e) => {\n              setMessage(e.target.value);\n            }}\n            defaultValue=\"receive\"\n          />\n        </Col>\n        <Col span={2}>\n          <Button onClick={sendMessage} type=\"primary\">\n            \u53d1\u9001\n          </Button>\n        </Col>\n      </Row>\n    </Input.Group>\n  );\n}\n\nexport default () => {\n  return (\n    <>\n      <MessageList />\n      <Divider />\n      <Chat />\n    </>\n  );\n};\n",jsx:"import React, { useState } from 'react';\nimport { Button, Input, Badge, Divider, Row, Col } from 'antd';\nimport { PubSub, useSubscribe } from '@wetrial/hooks';\nconst eventType = {\n  sendMessage: 'sendMessage',\n};\n\nfunction MessageList() {\n  const [messages, setMessages] = useState('');\n  useSubscribe(eventType.sendMessage, (_, data) => {\n    setMessages(data);\n  });\n  return (\n    <>\n      <Badge dot>\u6d88\u606f</Badge>\n      <Input.TextArea value={messages} />\n    </>\n  );\n}\n\nfunction Chat() {\n  const [message, setMessage] = useState('');\n\n  const sendMessage = (e) => {\n    e.preventDefault();\n    PubSub.publish(eventType.sendMessage, `${message}-${new Date().getTime()}`);\n    setMessage('');\n  };\n\n  return (\n    <Input.Group>\n      <Row>\n        <Col span={22}>\n          <Input\n            value={message}\n            onChange={(e) => {\n              setMessage(e.target.value);\n            }}\n            defaultValue=\"receive\"\n          />\n        </Col>\n        <Col span={2}>\n          <Button onClick={sendMessage} type=\"primary\">\n            \u53d1\u9001\n          </Button>\n        </Col>\n      </Row>\n    </Input.Group>\n  );\n}\n\nexport default () => {\n  return (\n    <>\n      <MessageList />\n      <Divider />\n      <Chat />\n    </>\n  );\n};\n"}},{path:"/_demos/use-pub-sub",CSSInDependencies:["antd/dist/antd.css"],dependencies:{react:">=16.9.0","react-dom":">=16.9.0",antd:"4.8.4"},files:{}}),s.a.createElement(l,null)),s.a.createElement("div",{className:"markdown"},s.a.createElement("h2",{id:"api"},s.a.createElement("a",{"aria-hidden":"true",href:"#api"},s.a.createElement("span",{className:"icon icon-link"})),"API"),s.a.createElement(i.a,{code:"import {usePublish, PubSub} from'@wetrial/hooks';\n\nuseSubscribe(event:string,(event:string,data:any)=>void);\nPubSub.publish(event:string,data:any);\n",lang:"typescript"})))}},kRpH:function(e,n,t){(function(e){(function(t,a){"use strict";var r={};t.PubSub=r,a(r),void 0!==e&&e.exports&&(n=e.exports=r),n.PubSub=r,e.exports=n=r})("object"===typeof window&&window||this,(function(e){"use strict";var n={},t=-1,a="*";function r(e){var n;for(n in e)if(e.hasOwnProperty(n))return!0;return!1}function s(e){return function(){throw e}}function u(e,n,t){try{e(n,t)}catch(a){setTimeout(s(a),0)}}function i(e,n,t){e(n,t)}function o(e,t,a,r){var s,o=n[t],c=r?i:u;if(n.hasOwnProperty(t))for(s in o)o.hasOwnProperty(s)&&c(o[s],e,a)}function c(e,n,t){return function(){var r=String(e),s=r.lastIndexOf(".");o(e,e,n,t);while(-1!==s)r=r.substr(0,s),s=r.lastIndexOf("."),o(e,r,n,t);o(e,a,n,t)}}function l(e){var t=String(e),a=Boolean(n.hasOwnProperty(t)&&r(n[t]));return a}function b(e){var n=String(e),t=l(n)||l(a),r=n.lastIndexOf(".");while(!t&&-1!==r)n=n.substr(0,r),r=n.lastIndexOf("."),t=l(n);return t}function d(e,n,t,a){e="symbol"===typeof e?e.toString():e;var r=c(e,n,a),s=b(e);return!!s&&(!0===t?r():setTimeout(r,0),!0)}e.publish=function(n,t){return d(n,t,!1,e.immediateExceptions)},e.publishSync=function(n,t){return d(n,t,!0,e.immediateExceptions)},e.subscribe=function(e,a){if("function"!==typeof a)return!1;e="symbol"===typeof e?e.toString():e,n.hasOwnProperty(e)||(n[e]={});var r="uid_"+String(++t);return n[e][r]=a,r},e.subscribeAll=function(n){return e.subscribe(a,n)},e.subscribeOnce=function(n,t){var a=e.subscribe(n,(function(){e.unsubscribe(a),t.apply(this,arguments)}));return e},e.clearAllSubscriptions=function(){n={}},e.clearSubscriptions=function(e){var t;for(t in n)n.hasOwnProperty(t)&&0===t.indexOf(e)&&delete n[t]},e.countSubscriptions=function(e){var t,a=0;for(t in n)n.hasOwnProperty(t)&&0===t.indexOf(e)&&a++;return a},e.getSubscriptions=function(e){var t,a=[];for(t in n)n.hasOwnProperty(t)&&0===t.indexOf(e)&&a.push(t);return a},e.unsubscribe=function(t){var a,r,s,u=function(e){var t;for(t in n)if(n.hasOwnProperty(t)&&0===t.indexOf(e))return!0;return!1},i="string"===typeof t&&(n.hasOwnProperty(t)||u(t)),o=!i&&"string"===typeof t,c="function"===typeof t,l=!1;if(!i){for(a in n)if(n.hasOwnProperty(a)){if(r=n[a],o&&r[t]){delete r[t],l=t;break}if(c)for(s in r)r.hasOwnProperty(s)&&r[s]===t&&(delete r[s],l=!0)}return l}e.clearSubscriptions(t)}}))}).call(this,t("YuTi")(e))},tJVT:function(e,n,t){"use strict";function a(e){if(Array.isArray(e))return e}function r(e,n){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var t=[],a=!0,r=!1,s=void 0;try{for(var u,i=e[Symbol.iterator]();!(a=(u=i.next()).done);a=!0)if(t.push(u.value),n&&t.length===n)break}catch(o){r=!0,s=o}finally{try{a||null==i["return"]||i["return"]()}finally{if(r)throw s}}return t}}t.d(n,"a",(function(){return i}));var s=t("Qw5x");function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,n){return a(e)||r(e,n)||Object(s["a"])(e,n)||u()}}}]);