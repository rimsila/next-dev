(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[52],{A9B3:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),r=a.n(n),l=(a("B2uJ"),a("+su7"),a("qOys")),o=a.n(l);a("5Yjd");t["default"]=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"markdown"},r.a.createElement("p",null,"UI testing is an important part of the project development process. Effective test cases can sort out business requirements, ensure the quality and progress of research and development, and allow engineers to refactor code and add new features with confidence."),r.a.createElement("p",null,"next-dev encapsulates a set of simple and easy-to-use React unit tests and E2E test solutions. Run the following commands in the project root directory to run the test cases."),r.a.createElement(o.a,{code:"$ npm run test:all # execute all tests\n",lang:"bash"}),r.a.createElement("img",{style:{boxShadow:"none",margin:"0"},src:"https://gw.alipayobjects.com/zos/rmsportal/EFKJzIswQgWNJzDQNpKr.png",width:"700"}),r.a.createElement("p",null,"The following briefly introduces how to write your business test cases in the project."),r.a.createElement("h2",{id:"unit-test"},r.a.createElement("a",{"aria-hidden":"true",href:"#unit-test"},r.a.createElement("span",{className:"icon icon-link"})),"unit test"),r.a.createElement("p",null,"Unit testing is used to test the performance of React UI components. We refer to ",r.a.createElement("a",{href:"https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.md#running-tests",target:"_blank",rel:"noopener noreferrer"},"create-react-app",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}))),", use ",r.a.createElement("a",{href:"http://facebook.github.io/jest/",target:"_blank",rel:"noopener noreferrer"}," jest",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))," as the testing framework."),r.a.createElement("p",null,"jest is a test framework that runs on the node side. It uses jsdom to simulate the DOM environment. It is suitable for quickly testing the logical performance of React components. For real browsers, please refer to the E2E test section."),r.a.createElement("h3",{id:"write-a-use-case"},r.a.createElement("a",{"aria-hidden":"true",href:"#write-a-use-case"},r.a.createElement("span",{className:"icon icon-link"})),"Write a use case"),r.a.createElement("p",null,"For example, we can create a file ",r.a.createElement("code",null,"src/routes/Result/Success.test.js")," to test the UI performance of the success page component."),r.a.createElement(o.a,{code:"import React from 'react';\nimport { shallow } from 'enzyme';\nimport Success from './Success'; // Import the corresponding React component\n\nit('renders with Result', () => {\n  const wrapper = shallow(<Success />); // render\n  expect(wrapper.find('Result').length).toBe(1); // There is a Result component\n  expect(wrapper.find('Result').prop('type')).toBe('success'); // The type of Result component is success\n});\n",lang:"tsx"}),r.a.createElement("p",null,"Here, ",r.a.createElement("a",{href:"http://airbnb.io/enzyme/docs/api/index.html",target:"_blank",rel:"noopener noreferrer"},"enzyme",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))," is used as the test library, which provides a large number of useful APIs to help us test React components. The assertion part follows jest's default ",r.a.createElement("a",{href:"https://facebook.github.io/jest/docs/en/expect.html#content",target:"_blank",rel:"noopener noreferrer"},"jasmine2 expect syntax",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}))),"."),r.a.createElement("h3",{id:"local-execution"},r.a.createElement("a",{"aria-hidden":"true",href:"#local-execution"},r.a.createElement("span",{className:"icon icon-link"})),"Local execution"),r.a.createElement("p",null,"Use the following commands to search and execute the use case files in the format of ",r.a.createElement("code",null,"*.test.js")," under ",r.a.createElement("code",null,"src"),"."),r.a.createElement(o.a,{code:"$ npm test .test.js\n",lang:"bash"}),r.a.createElement("h4",{id:"execute-a-single-or-group-of-use-cases"},r.a.createElement("a",{"aria-hidden":"true",href:"#execute-a-single-or-group-of-use-cases"},r.a.createElement("span",{className:"icon icon-link"})),"Execute a single or group of use cases"),r.a.createElement(o.a,{code:"$ npm test src/routes/Result/Success.test.js  # \u6d4b\u8bd5 Success.test.js\n$ npm test src/routes # Test all use case files under routes\n",lang:"bash"}),r.a.createElement("h3",{id:"test-the-dva-package-component"},r.a.createElement("a",{"aria-hidden":"true",href:"#test-the-dva-package-component"},r.a.createElement("span",{className:"icon icon-link"})),"Test the dva package component"),r.a.createElement("p",null,"React components that are dva ",r.a.createElement("code",null,"connect")," can be tested in the following ways."),r.a.createElement(o.a,{code:"import React from 'react';\nimport { shallow } from 'enzyme';\nimport Dashboard from './Dashboard';\n\nit('renders Dashboard', () => {\n  // Use packaged components\n  const wrapper = shallow(<Dashboard.WrappedComponent user={{ list: [] }} />);\n  expect(wrapper.find('Table').props().dataSource).toEqual([]);\n});\n",lang:"tsx"}),r.a.createElement("h2",{id:"e2e-test"},r.a.createElement("a",{"aria-hidden":"true",href:"#e2e-test"},r.a.createElement("span",{className:"icon icon-link"})),"e2e test"),r.a.createElement("p",null,"End-to-end testing is also called smoke testing. It is used to test the flow and performance of front-end applications in a real browser environment, which is equivalent to replacing manual operations with applications."),r.a.createElement("p",null,"We introduced ",r.a.createElement("a",{href:"https://github.com/googlechrome/puppeteer",target:"_blank",rel:"noopener noreferrer"},"puppeteer",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))," as a tool for E2E testing. Puppeteer is the official headless Chrome tool of the Google Chrome team. It uses chrome / chromium as the browser environment to run your application by default, and provides a very semantic API to describe business logic."),r.a.createElement("h3",{id:"write-an-e2e-use-case"},r.a.createElement("a",{"aria-hidden":"true",href:"#write-an-e2e-use-case"},r.a.createElement("span",{className:"icon icon-link"})),"Write an e2e use case"),r.a.createElement("p",null,"Suppose there is a requirement that the user enters the wrong user name and password on the login page, and after clicking login, an error message box appears."),r.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/oZeYewGOUJkmqXAPoOFC.gif",width:"400"}),r.a.createElement("p",null,"We write a use case to protect this process. Create a ",r.a.createElement("code",null,"Login.e2e.js")," file under the ",r.a.createElement("code",null,"src/e2e/")," directory, and describe the test case according to the above business requirements."),r.a.createElement(o.a,{code:"import puppeteer from 'puppeteer';\n\ndescribe('Login', () => {\n  it('should login with failure', async () => {\n    const browser = await puppeteer.launch();\n    const page = await browser.newPage();\n    await page.type('#userName', 'mockuser');\n    await page.type('#password', 'wrong_password');\n    await page.click('button[type=\"submit\"]');\n    await page.waitForSelector('.ant-alert-error'); // should display error\n    await page.close();\n    browser.close();\n  });\n});\n",lang:"js"}),r.a.createElement("p",null,"For more puppeteer methods, please refer to ",r.a.createElement("a",{href:"https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md",target:"_blank",rel:"noopener noreferrer"},"puppeteer/docs/api.md",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}))),"."),r.a.createElement("h3",{id:"run-use-cases"},r.a.createElement("a",{"aria-hidden":"true",href:"#run-use-cases"},r.a.createElement("span",{className:"icon icon-link"})),"Run use cases"),r.a.createElement("p",null,"Running the following command will execute all ",r.a.createElement("code",null,"*.e2e.js")," use case files under src."),r.a.createElement(o.a,{code:"$ npm test .e2e.js\n",lang:"bash"}),r.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/LGCXopksUYMUhjRgdYSz.png",width:"700"}),r.a.createElement("blockquote",null,r.a.createElement("p",null,"Note that the local test e2e use case needs to start ",r.a.createElement("code",null,"npm start"),", otherwise an error of ",r.a.createElement("code",null,"Failed: navigation error")," will be reported.")),r.a.createElement("h2",{id:"watch-mode"},r.a.createElement("a",{"aria-hidden":"true",href:"#watch-mode"},r.a.createElement("span",{className:"icon icon-link"})),"watch mode"),r.a.createElement(o.a,{code:"$ npm test -- --watch\n",lang:"unknown"}),r.a.createElement("p",null,"Add ",r.a.createElement("code",null,"--watch")," configuration to enter watch mode. When you modify and save the file, Jest will automatically execute the corresponding application example. Jest's command line tool also provides a variety of convenient shortcut keys to perform the use cases you need."),r.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/rmsportal/MnmxiavystfcBDskyKRg.png",width:"700"}),r.a.createElement("h2",{id:"test-coverage"},r.a.createElement("a",{"aria-hidden":"true",href:"#test-coverage"},r.a.createElement("span",{className:"icon icon-link"})),"Test coverage"),r.a.createElement(o.a,{code:"$ npm test -- --coverage\n",lang:"unknown"}),r.a.createElement("p",null,"Add ",r.a.createElement("code",null,"--coverage")," configuration to display the test coverage of the project."),r.a.createElement("img",{src:"https://camo.githubusercontent.com/bd0bbda8e44ea747e4c199d0e212d40563ad2fcb/687474703a2f2f692e696d6775722e636f6d2f356246686e54532e706e67",width:"700"}),r.a.createElement("h2",{id:"focus-and-ignore-use-cases"},r.a.createElement("a",{"aria-hidden":"true",href:"#focus-and-ignore-use-cases"},r.a.createElement("span",{className:"icon icon-link"})),"Focus and ignore use cases"),r.a.createElement("p",null,"Using ",r.a.createElement("code",null,"xit()")," instead of ",r.a.createElement("code",null,"it()")," can temporarily ignore the use case, and ",r.a.createElement("code",null,"fit()")," can focus on the current use case and ignore all other use cases. These two methods can help you focus only on the use cases you currently need during the development process."),r.a.createElement("h2",{id:"access-integration-test-service"},r.a.createElement("a",{"aria-hidden":"true",href:"#access-integration-test-service"},r.a.createElement("span",{className:"icon icon-link"})),"Access integration test service"),r.a.createElement("p",null,"If you need to access travis, CircleCI, Gitlab CI and other integrated test environments, you can refer to the ",r.a.createElement("code",null,".travis.yml")," provided by this repository."),r.a.createElement("p",null,"Note that e2e testing requires an integrated environment to support electron. If not, you can use ",r.a.createElement("code",null,"npm test .test.js")," to run unit tests separately."),r.a.createElement("h2",{id:"reference-link"},r.a.createElement("a",{"aria-hidden":"true",href:"#reference-link"},r.a.createElement("span",{className:"icon icon-link"})),"Reference link"),r.a.createElement("p",null,"For more testing techniques and functions, please refer to the following link."),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.md#running-tests",target:"_blank",rel:"noopener noreferrer"},"create-react-app tests",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),r.a.createElement("li",null,r.a.createElement("a",{href:"https://facebook.github.io/jest/",target:"_blank",rel:"noopener noreferrer"},"is",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),r.a.createElement("li",null,r.a.createElement("a",{href:"http://airbnb.io/enzyme/",target:"_blank",rel:"noopener noreferrer"},"enzyme",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),r.a.createElement("li",null,r.a.createElement("a",{href:"https://github.com/googlechrome/puppeteer",target:"_blank",rel:"noopener noreferrer"},"puppeteer",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))),r.a.createElement("li",null,r.a.createElement("a",{href:"https://facebook.github.io/jest/docs/en/puppeteer.html",target:"_blank",rel:"noopener noreferrer"},"Using with puppeteer",r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"__dumi-default-external-link-icon"},r.a.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.a.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})))))))}}}]);